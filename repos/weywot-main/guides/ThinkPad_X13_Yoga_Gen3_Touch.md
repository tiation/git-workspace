# Make the X13 Yoga Gen3 Touchscreen identified by Gnome 45
This was done on Fedora 39, but should work for most other Gnome based distributions.
## UPDATE

Since F41 (Gnome 47) the correct device (5284) is identified by Gnome and it appears on settings with a warnging (not recognised). The available options are the same as when you follow the guide below. 

There is still no file for the 5284 in libwacom, and libwacom won't list anything without the intervention in the guide below.

## Identify the issue
Opening Gnome Settings under "Wacom Tablet" shows "No tablet Detected".
![image](https://github.com/spxak1/weywot/assets/29977030/b109553c-2062-4ee5-835d-22aa53803f9b)


This can be confirmed by issuing
~~~
otheos@weywot:~$ libwacom-list-local-devices 
/dev/input/event7 is a tablet but not supported by libwacom
Failed to find any devices known to libwacom
~~~

The issue remains even after updating libwacom devices with ```sudo libwacom-update-db".

## Identify the device ID
The problem is that ```libwacom``` doesn't have a descriptor for the specific device. 
So let's find the device.

I use my **ThinkPad X13 Yoga Gen3** for this.

~~~
otheos@weywot:~$ sudo dmesg | grep Wacom
[    2.768120] input: Wacom HID 5284 Pen as /devices/pci0000:00/0000:00:15.1/i2c_designware.1/i2c-1/i2c-WACF2200:00/0018:056A:5284.0002/input/input17
[    2.768760] input: Wacom HID 5284 Finger as /devices/pci0000:00/0000:00:15.1/i2c_designware.1/i2c-1/i2c-WACF2200:00/0018:056A:5284.0002/input/input18
~~~

The touchscreen device is a WACF2200 (supported) with an id of **056A:5284**.

## Create the file for libwacom to identify the touchscreen
More details regarding these files and more are [here](https://github.com/linuxwacom/libwacom/blob/master/README.md).

These files are in ```/usr/share/libwacom```.

Doing a quick ```ls``` in that folder shows many files named ```isdv4-XXXX.tablet```. 
The ```XXXX``` part is the device ID, in our case ```5284```. 

As of this writing there is **no*** ```isdv4-5284.tablet``` file.
There **is** however a file named ```isdv4-5285.tablet``` which looks very close to what we want. 

It looks like this:
~~~
# Lenovo ThinkPad X13 Yoga Gen 2
# Sensor Type: AES
# Features: Touch (Integrated), Tilt
# HW Resolution: 28604 x 17878 (2540 x 2540 lpi)
#
# Autogenerated from sysinfo.AP2hbJxj8g
# https://github.com/linuxwacom/wacom-hid-descriptors/issues/188#issue-1096423544

[Device]
Name=ISDv4 5285
ModelName=
DeviceMatch=i2c:056a:5285
Class=ISDV4
Width=11
Height=7
IntegratedIn=Display;System
Styli=@isdv4-aes;

[Features]
Stylus=true
Touch=true
~~~

It is clear this is for the **Gen 2** X13, so the touchscreen devices are (probably) the same with different device numbers.

So let's make a copy:
~~~
otheos@weywot:~$ sudo su
root@weywot:/home/otheos# cd /usr/share/libwacom/
root@weywot:/usr/share/libwacom# cp isdv4-5285.tablet isdv4-5284.tablet
~~~

Now let's edit the new file:Wacom 5284	- ThinkPad X13 Yoga Gen	3
~~~
# Lenovo ThinkPad X13 Yoga Gen 3
# Sensor Type: AES
# Features: Touch (Integrated), Tilt
# HW Resolution: 28604 x 17878 (2540 x 2540 lpi)
#
# Autogenerated from sysinfo.AP2hbJxj8g
# https://github.com/linuxwacom/wacom-hid-descriptors/issues/188#issue-10964235>


[Device]
Name=Wacom 5284	- ThinkPad X13 Yoga Gen	3
ModelName=WACF2200
DeviceMatch=i2c:056a:5284
Class=ISDV4
Width=11
Height=7
IntegratedIn=Display;System
Styli=@isdv4-aes;

[Features]
Stylus=true
Touch=true
~~~

Note: The most important change is the **DeviceMatch** changed to **5284**.

Reboot.

## Test it
After the reboot, fire up Gnome Settings and go to the Wacom Tab:
![image](https://github.com/spxak1/weywot/assets/29977030/ea5599d5-35f8-42be-82e0-279258a4782d)

**Note**: The Stylus is missing. You need to interact with that screen with the stylus for it to appear.

![image](https://github.com/spxak1/weywot/assets/29977030/2d08a0b5-1916-4186-9541-d0976c727eee)


You can confirm from the terminal:
~~~
otheos@weywot:~$ libwacom-list-local-devices
devices:
- name: 'Wacom 5284 - ThinkPad X13 Yoga Gen 3'
  bus: 'i2c'
  vid: '0x056a'
  pid: '0x5284'
  nodes: 
  - /dev/input/event7: 'Wacom HID 5284 Pen'
~~~

That's it.

Please note: **The functionality of the touchscreen does not chage or improve.**
